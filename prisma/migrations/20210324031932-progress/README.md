# Migration `20210324031932-progress`

This migration has been generated by Kouatchoua Mark at 3/24/2021, 4:19:32 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "Skill" DROP CONSTRAINT "Skill_roleId_fkey"

ALTER TABLE "Town" DROP CONSTRAINT "Town_divisionId_fkey"

ALTER TABLE "Town" DROP COLUMN "divisionId",
ADD COLUMN     "subdivisionId" TEXT

CREATE TABLE "Subdivision" (
    "id" TEXT NOT NULL,
    "subdivName" TEXT NOT NULL,
    "subdivCode" TEXT NOT NULL,
    "divisionId" TEXT,

    PRIMARY KEY ("id")
)

CREATE TABLE "School" (
    "id" TEXT NOT NULL,
    "schoolName" TEXT NOT NULL,
    "schoolNumber" TEXT NOT NULL,
    "schoolCode" TEXT NOT NULL,
    "townId" TEXT,

    PRIMARY KEY ("id")
)

CREATE TABLE "Section" (
    "id" TEXT NOT NULL,
    "sectionName" TEXT NOT NULL,
    "sectionCode" TEXT NOT NULL,
    "schoolId" TEXT,

    PRIMARY KEY ("id")
)

CREATE TABLE "Department" (
    "id" TEXT NOT NULL,
    "deptName" TEXT NOT NULL,
    "deptCode" TEXT NOT NULL,
    "sectionId" TEXT,

    PRIMARY KEY ("id")
)

CREATE TABLE "Prof" (
    "id" TEXT NOT NULL,
    "prof1stName" TEXT NOT NULL,
    "prof2ndName" TEXT NOT NULL,
    "prof3rdName" TEXT NOT NULL,
    "profMatricule" TEXT NOT NULL,
    "specialty" TEXT NOT NULL,
    "departmentId" TEXT,

    PRIMARY KEY ("id")
)

DROP TABLE "Role"

DROP TABLE "Skill"

ALTER TABLE "Subdivision" ADD FOREIGN KEY("divisionId")REFERENCES "Division"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "School" ADD FOREIGN KEY("townId")REFERENCES "Town"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "Section" ADD FOREIGN KEY("schoolId")REFERENCES "School"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "Department" ADD FOREIGN KEY("sectionId")REFERENCES "Section"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "Prof" ADD FOREIGN KEY("departmentId")REFERENCES "Department"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "Town" ADD FOREIGN KEY("subdivisionId")REFERENCES "Subdivision"("id") ON DELETE SET NULL ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20210323165653-understood..20210324031932-progress
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -23,37 +23,76 @@
 }
 model Division {
-  id           String @id @default(cuid())
+  id           String        @id @default(cuid())
   divisionName String
   divisionCode String
-  town         Town[]
+  subdiv       Subdivision[]
   Region   Region? @relation(fields: [regionId], references: [id])
   regionId String?
 }
+model Subdivision {
+  id         String @id @default(cuid())
+  subdivName String
+  subdivCode String
+  town       Town[]
+
+  Division   Division? @relation(fields: [divisionId], references: [id])
+  divisionId String?
+}
+
 model Town {
   id       String @id @default(cuid())
   townName String
   townCode String
-  Division   Division? @relation(fields: [divisionId], references: [id])
-  divisionId String?
+  school        School[]
+  Subdivision   Subdivision? @relation(fields: [subdivisionId], references: [id])
+  subdivisionId String?
 }
+model School {
+  id           String @id @default(cuid())
+  schoolName   String
+  schoolNumber String
+  schoolCode   String
-model Role {
-  id        Int     @id @default(autoincrement())
-  name      String?
-  skills    Skill[]
+  section Section[]
+
+  Town   Town?   @relation(fields: [townId], references: [id])
+  townId String?
 }
-// 1-n with role
-model Skill {
-  id     Int    @id @default(autoincrement())
-  name   String?
-  role   Role?   @relation(fields: [roleId], references: [id])
-  roleId Int?
+model Section {
+  id          String @id @default(cuid())
+  sectionName String
+  sectionCode String
+
+  department Department[]
+
+  School   School? @relation(fields: [schoolId], references: [id])
+  schoolId String?
 }
+model Department {
+  id        String   @id @default(cuid())
+  deptName  String
+  deptCode  String
+  prof      Prof[]
+  Section   Section? @relation(fields: [sectionId], references: [id])
+  sectionId String?
+}
+
+model Prof {
+  id            String @id @default(cuid())
+  prof1stName   String
+  prof2ndName   String
+  prof3rdName   String
+  profMatricule String
+  specialty     String
+
+  Department   Department? @relation(fields: [departmentId], references: [id])
+  departmentId String?
+}
```


